


## Что это?

Данная программа рисует [Mandelbrot Set](https://en.wikipedia.org/wiki/Mandelbrot_set) (Мно́жество Мандельбро́та)

Основной файл для запуска: `0Mandelbrot.pas`  
Его заранее откомпилированную версию можно скачать [тут](https://github.com/SunSerega/temp-Mandelbrot-example/releases/tag/latest-exe-tag).

Но рекомендую сначала скачать весь репозиторий и посмотреть в файл `Settings.pas`.  
Особенно на секцию для `VRAM`, `RAM` и `Drive` памяти.  
И затем запускать `0Mandelbrot.pas` чтобы применить изменения.

---

## Управление

- Escape:      Завершение программы (дважды или +Ctrl чтобы отменить сохранение)
- Mouse Drag:  Быстрое движение камеры
- Arrows:      Гладкое движение камеры
- Scroll:      Быстрое изменение масштаба
- "+" и "-":   Гладкое изменение масштаба
- Space:       Сбросить положение камеры
- Ctrl+C:      Скопировать положение камеры (+Shift чтобы добавить комментарий)
- Ctrl+V:      Вставить положение камеры
- Win+V:       Вставить положение камеры из истории буфера обмена
- Q:           Сбросить визуальную информацию предыдущих кадров

---

## В кратце про этот "Mandelbrot Set"

Есть рекуррентная функция `z_next(z) = z^2 + c`, то есть:

- `z0 = c`
- `z1 = z0^2 + c`
- `z2 = z1^2 + c`

и т.д.

Переменная `c` в этой функции - комплексное число `x + y*i`,
где `x` и `y` это координаты в пространстве.

По теории уже доказано что если `|z|` (расстояние от центра координат) оказывается `>2`,
то далее расстояние от центра будет увеличиваться с каждым шагом.

Но так же есть точки `c`, для которых `z` никогда не улетает в бесконечность.  
Такие точки как раз входят в так-называемое "Множество Мандельброта".

А рисуют обычно точки, которые таки улетели в бесконечность.  
Точнее, цвет выбирают исходя из того - сколько шагов успели посчитать до `|z|>2`

В данной программе:
- Если после всех шагов всё ещё `|z|<=2`, то цвет белый (чтобы не мигало пока считает)
- Если 0 успешных шагов (т.е. уже `|c|>2`), то цвет чёрный (сливается с фоном)
- В остальных случаях цвет радужный, в зависимости от кол-ва шагов

(можно менять в `Shaders\Rainbow.frag`)

Большинство подобных программ заранее выбирают максимальное кол-ва шагов функции.  
Но в данной программе использован другой подход: Чем дольше подождёте - тем больше нарисует.

К примеру, рекомендую скопировать и вставить в программу (Ctrl+V) это:
```
c=цветениее
pos.r=-001.0000000001011001010100101010|00001010111000001011111110001100
pos.i=+000.0100000000000000100011001100|11100001101100110111110010100100
scale=1.807566*2^-17
```
(два "е" в конце комментария это не описка, а чтобы TTS произносил правильно)

---

## `MandelbrotSampling.cl`

В этом файле находятся основная часть кода на GPU, считающая рекуррентную функцию.  
Чтобы тестировать его поведение написаны вспомогательные программы:

- `SamplingTests.pas`: Тесты отдельных подпрограмм
- `FieldTest.pas`: Тест всего и сразу, с ограниченным кол-вом шагов и простейшим рендерингом в файл.


